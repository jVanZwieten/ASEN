clear; clc; close all;
addpath("..")

%% 3a
[eta, X] = boundaryLayerSolver(10, 0.4612488223985730107, 2, 6.777527730842649589); sgtitle("M_e = 10, g = 2");
f = X(:, 1);  % f
a = X(:, 2);  % f'
b = X(:, 3);  % f''
g = X(:, 4);  % g = h/h_e
e = X(:, 5);  % g'
z = X(:, 6);  % yâˆš(Re_x)/x

figure(1);
subplot(2, 1, 1);
plot(z, a, 'LineWidth', 1.5);
xlabel('$$\frac{y \sqrt{Re_x}}{x}$$', 'Interpreter', 'latex'); ylabel('u/u_e');
title('Velocity Profile');
xlim([0 20]);

subplot(2, 1, 2);
plot(z, g, 'LineWidth', 1.5);
xlabel('$$\frac{y \sqrt{Re_x}}{x}$$', 'Interpreter', 'latex'); ylabel('T/T_e');
title('Temperature Profile');
xlim([0 20]);

%% 3b
input = [1.000000000000000000E+00  3.000000000000000000E+00  5.793473856770532393E-01 -9.606155659519324264E-01
2.000000000000000000E+00  3.000000000000000000E+00  5.755627422717082275E-01 -6.846374319941257447E-01
3.000000000000000000E+00  3.000000000000000000E+00  5.697122834232921651E-01 -2.328327294710773321E-01
4.000000000000000000E+00  3.000000000000000000E+00  5.623280508423661450E-01  3.847379529978664503E-01
5.000000000000000000E+00  3.000000000000000000E+00  5.539414542200393754E-01  1.157136857170555366E+00
6.000000000000000000E+00  3.000000000000000000E+00  5.450039226371871104E-01  2.073919175056289976E+00
7.000000000000000000E+00  3.000000000000000000E+00  5.358590369156396305E-01  3.125822749222743280E+00
8.000000000000000000E+00  3.000000000000000000E+00  5.267478912914680400E-01  4.304956180484514228E+00
9.000000000000000000E+00  3.000000000000000000E+00  5.178285065894165928E-01  5.604716683020855683E+00
1.000000000000000000E+01  3.000000000000000000E+00  5.091973972178346353E-01  7.019603083145855571E+00
1.100000000000000000E+01  3.000000000000000000E+00  5.009080887232384427E-01  8.545012889843235371E+00
1.200000000000000000E+01  3.000000000000000000E+00  4.929852639542537940E-01  1.017706106723019133E+01
1.300000000000000000E+01  3.000000000000000000E+00  4.854349002347614905E-01  1.191243123509900848E+01
1.400000000000000000E+01  3.000000000000000000E+00  4.782512592752874991E-01  1.374825831700339229E+01
1.500000000000000000E+01  3.000000000000000000E+00  4.714215867226709822E-01  1.568203768212530491E+01
1.600000000000000000E+01  3.000000000000000000E+00  4.649292131091088409E-01  1.771155524031663120E+01
1.700000000000000000E+01  3.000000000000000000E+00  4.587555660968598570E-01  1.983483361267906275E+01
1.800000000000000000E+01  3.000000000000000000E+00  4.528814524741613390E-01  2.205009046696557107E+01
1.900000000000000000E+01  3.000000000000000000E+00  4.472878553724830009E-01  2.435570601916986533E+01
2.000000000000000000E+01  3.000000000000000000E+00  4.419564122965908282E-01  2.675019745086473932E+01];

for i = 1:20
    [eta, X] = boundaryLayerSolver(input(i, 1), input(i, 3), input(i, 2), input(i, 4));

    figure(2);
    hold on;
    plot(X(:, 6), X(:, 2), 'DisplayName', ['M_e = ', num2str(input(i, 1))], 'LineWidth', 1.5);
    xlabel('$$\frac{y \sqrt{Re_x}}{x}$$', 'Interpreter', 'latex'); ylabel('u/u_e');
    title('Velocity Profile, g = 3');
    xlim([0 45]);
    legend show;

    figure(3);
    hold on;
    plot(X(:, 6), X(:, 4), 'DisplayName', ['M_e = ', num2str(input(i, 1))], 'LineWidth', 1.5);
    xlabel('$$\frac{y \sqrt{Re_x}}{x}$$', 'Interpreter', 'latex'); ylabel('T/T_e');
    title('Temperature Profile, g = 3');
    xlim([0 45]);
    legend show;
end

%% 3d
[eta, X_adiabatic] = boundaryLayerSolver(10, .7470042861549140989, 18.11287757987922475, 0);
figure(4)
plot(X_adiabatic(:, 6), X_adiabatic(:, 2), 'DisplayName', 'adiabatic', 'LineWidth', 1.5);
xlabel('$$\frac{y \sqrt{Re_x}}{x}$$', 'Interpreter', 'latex'); ylabel('u/u_e');
title('Velocity Profile');
xlim([0 45]);

figure(5)
plot(X_adiabatic(:, 6), X_adiabatic(:, 4), 'DisplayName', 'adiabatic', 'LineWidth', 1.5);
xlabel('$$\frac{y \sqrt{Re_x}}{x}$$', 'Interpreter', 'latex'); ylabel('T/T_e');
title('Temperature Profile');
xlim([0 45]);

[eta, X_cold] = boundaryLayerSolver(10, 3.864798193925640390E-01, 1, 6.029156361331501124);
figure(4)
hold on
plot(X_cold(:, 6), X_cold(:, 2), 'DisplayName', 'cold', 'LineWidth', 1.5);
legend show

figure(5)
hold on
plot(X_cold(:, 6), X_cold(:, 4), 'DisplayName', 'cold', 'LineWidth', 1.5);
legend show

a = 13.82;
b = 33.86;
b/a

C_wCold = 1^(.72 - 1)
C_wAdiabatic = 18.11287757987922475^(.72 - 1)

C_wCold*3.864798193925640390E-01/C_wAdiabatic/.7470042861549140989